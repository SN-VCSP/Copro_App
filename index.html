<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>Poubelles Copro</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
  <style>
    :root{
      --bg1:#3ea76a; --bg2:#a7f3d0; /* vert poubelle clair */
      --card:#0b1225; --text:#f8fafc; --muted:#cbd5e1;
      --ring:#334155;
    }
    *{box-sizing:border-box}
    html,body{
      margin:0;padding:0;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:linear-gradient(135deg,var(--bg1),var(--bg2));
      color:var(--text)
    }
    header{
      position:sticky;top:0;z-index:50;
      background:linear-gradient(90deg,#22c55e,#84cc16);
      padding:14px 16px;border-bottom:1px solid rgba(255,255,255,.2);
      display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap
    }
    .brand{display:flex;align-items:center;gap:10px;flex:1}
    .logo{width:32px;height:32px;border-radius:10px;background:conic-gradient(#22c55e,#f59e0b,#06b6d4,#84cc16)}
    .brand h1{margin:0;font-size:16px}
    nav{display:flex;gap:8px;margin-top:6px}
    nav button{
      flex:1;padding:8px;border:1px solid rgba(255,255,255,.2);
      border-radius:10px;background:rgba(0,0,0,.25);color:var(--text);
      font-weight:600;font-size:14px;transition:all .2s
    }
    nav button.active{border-color:#fff;box-shadow:0 0 10px rgba(255,255,255,.5) inset}
    main{padding:12px}
    .card{
      background:rgba(11,18,37,.85);
      backdrop-filter:blur(6px);
      border:1px solid var(--ring);
      border-radius:14px;
      padding:14px;margin-bottom:14px
    }

    /* Accueil */
    .hero-center{text-align:center;padding:20px}
    .hero-center h2{margin:6px 0;font-size:20px}
    .hero-center .date{font-size:14px;color:#d1d5db;margin-bottom:8px}
    .hero-center .week{font-size:16px;color:#facc15;margin-bottom:12px}
    .hero-center .resp{font-size:24px;font-weight:700;margin-bottom:12px}
    .hero-center .nextTask, .hero-center .nextWeek{font-size:14px;color:#d1d5db;margin-top:6px}

    /* Planning */
    .month-nav{
      display:flex;align-items:center;justify-content:center;gap:10px;
      font-weight:700;margin-bottom:8px;font-size:16px;flex-wrap:wrap
    }
    .month-nav button{
      background:#0f172a;border:none;color:#fff;cursor:pointer;
      border-radius:8px;padding:4px 8px;font-size:15px
    }
    .week{
      background:#1e293b;border:1px solid var(--ring);
      border-radius:10px;padding:10px;margin-bottom:8px
    }
    .week h3{margin:0 0 6px 0;font-size:14px;color:#facc15}
    .week.libre{background:#374151}
    .week h3.libre{color:#f87171} /* rouge pour LIBRE */
    .task{margin:3px 0;padding:4px 6px;border-radius:6px;background:#0b1225;font-size:13px}

    .footer{padding:10px;color:#e2e8f0;font-size:11px;text-align:center}
    @media(max-width:500px){
      .hero-center h2{font-size:18px}
      .hero-center .resp{font-size:20px}
      .task{font-size:12px}
    }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="logo"></div>
      <h1>üöÆ Poubelles Copro</h1>
    </div>
    <nav>
      <button id="tab-home" class="active">Accueil</button>
      <button id="tab-planning">Planning</button>
    </nav>
  </header>

  <main>
    <!-- Accueil -->
    <section id="home" class="tabs active">
      <div class="card hero-center">
        <div class="date" id="todayText">‚Äî</div>
        <div class="week" id="weekInfo">‚Äî</div>
        <div class="resp" id="heroWho">Responsable: ‚Äî</div>
        <div class="nextTask" id="heroTask">Prochaine t√¢che: ‚Äî</div>
        <div class="nextWeek" id="nextResp">Prochaine semaine: ‚Äî</div>
      </div>
    </section>

    <!-- Planning -->
    <section id="planning" class="tabs">
      <div class="card">
        <div class="month-nav">
          <button id="prevMonth">‚óÄÔ∏è</button>
          <span id="monthLabel">‚Äî</span>
          <button id="nextMonth">‚ñ∂Ô∏è</button>
        </div>
        <div id="weeksContainer"></div>
      </div>
    </section>
  </main>

  <div class="footer">R√®gle: 1er lundi ‚Üí Sofienn, puis Vanessa, Anthony, Marc. 5e semaine = LIBRE.</div>

<script>
/* === Donn√©es === */
const PEOPLE=["Sofienn","Vanessa","Anthony","Marc"];
const TASKS=[
  {icon:"üóëÔ∏è",label:"Sortie",whenLabel:"Mardi soir",dow:2,time:"18:00"},
  {icon:"üè†",label:"Rentr√©e",whenLabel:"Mercredi matin",dow:3,time:"08:00"},
  {icon:"üóëÔ∏è",label:"Sortie",whenLabel:"Vendredi soir",dow:5,time:"18:00"},
  {icon:"üè†",label:"Rentr√©e",whenLabel:"Samedi matin",dow:6,time:"08:00"},
];

/* Helpers */
function pad(n){return n<10?"0"+n:n;}
function fmtDate(d){return `${pad(d.getDate())}/${pad(d.getMonth()+1)}/${d.getFullYear()}`;}
function startOfDay(d){const x=new Date(d);x.setHours(0,0,0,0);return x;}
function addDays(d,n){const x=new Date(d);x.setDate(x.getDate()+n);return x;}
function setTime(d,hhmm){const x=new Date(d);const [hh,mm]=hhmm.split(":").map(Number);x.setHours(hh||0,mm||0,0,0);return x;}
function firstMondayOfMonth(y,m){const d=new Date(y,m,1);const day=d.getDay();const off=(day===0)?1:(day===1?0:(8-day)%7);d.setDate(d.getDate()+off);return startOfDay(d);}

/* Planning */
let PLAN=[], FUTURE_MONTHS=[], currentMonthIndex=0;
function buildMonth(year,monthIdx){
  const firstMon=firstMondayOfMonth(year,monthIdx);
  const weeks=[];
  for(let w=0;w<5;w++){
    const ws=addDays(firstMon,7*w);
    if(ws.getMonth()!==monthIdx && w>0) break;
    let responsible=null;
    if(w<4) responsible=PEOPLE[w];
    const tasks=TASKS.map(t=>{
      const delta=(t.dow+6)%7;
      const dd=addDays(ws,delta);
      return {date:setTime(dd,t.time),icon:t.icon,label:t.label,whenLabel:t.whenLabel,who:responsible||"LIBRE"};
    });
    weeks.push({weekStart:ws,responsible:responsible||"LIBRE",isLibre:!responsible,tasks});
  }
  return {year,monthIdx,weeks};
}
function generateYearPlan(){
  const now=new Date();const y0=now.getFullYear();const m0=now.getMonth();const plan=[];
  for(let i=0;i<12;i++){
    const y=(m0+i>=12)?y0+1:y0;const m=(m0+i)%12;
    plan.push(buildMonth(y,m));
  }
  PLAN=plan;
  FUTURE_MONTHS=PLAN.filter(m=>{
    const nm=new Date();
    return (m.year>nm.getFullYear())||(m.year===nm.getFullYear()&&m.monthIdx>=nm.getMonth());
  });
}

/* Trouver semaine actuelle et prochaine t√¢che */
function findCurrentWeek(){
  const now=new Date();let hit=null;
  PLAN.forEach(m=>m.weeks.forEach((w,i)=>{
    const end=addDays(w.weekStart,7);
    if(now>=w.weekStart&&now<end) hit={...w,index:i+1};
  }));
  return hit;
}
function findNextTask(){
  const now=new Date();let nearest=null;
  PLAN.forEach(m=>m.weeks.forEach(w=>w.tasks.forEach(t=>{
    if(t.date>now){if(!nearest||t.date<nearest.date) nearest=t;}
  })));
  return nearest;
}
function findNextWeek(currentWeek){
  if(!currentWeek) return null;
  let foundNext=null;
  PLAN.forEach(m=>m.weeks.forEach((w,i)=>{
    if(w.weekStart>currentWeek.weekStart && !foundNext) foundNext={...w,index:i+1};
  }));
  return foundNext;
}

/* UI */
function setActiveTab(tab){
  document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
  document.querySelectorAll(".tabs").forEach(s=>s.classList.remove("active"));
  document.getElementById(`tab-${tab}`).classList.add("active");
  document.getElementById(tab).classList.add("active");
}
function renderHome(){
  const now=new Date();
  document.getElementById("todayText").textContent=`Aujourd'hui : ${fmtDate(now)}`;
  const cw=findCurrentWeek();
  if(cw){
    document.getElementById("weekInfo").textContent=`Semaine ${cw.index}`;
    document.getElementById("heroWho").textContent=`Responsable: ${cw.responsible}`;
  }
  const nt=findNextTask();
  if(nt){
    document.getElementById("heroTask").textContent=`Prochaine t√¢che: ${nt.icon} ${nt.label} ‚Äî ${nt.whenLabel} (${fmtDate(new Date(nt.date))}) ‚Ä¢ ${nt.who}`;
  }
  const nw=findNextWeek(cw);
  if(nw){
    document.getElementById("nextResp").textContent=`Prochaine semaine: ${nw.responsible}`;
  }
}
function renderWeeks(){
  if(FUTURE_MONTHS.length===0)return;
  const names=["Janvier","F√©vrier","Mars","Avril","Mai","Juin","Juillet","Ao√ªt","Septembre","Octobre","Novembre","D√©cembre"];
  const current=FUTURE_MONTHS[currentMonthIndex];
  document.getElementById("monthLabel").textContent=`${names[current.monthIdx]} ${current.year}`;
  const cont=document.getElementById("weeksContainer");cont.innerHTML="";
  current.weeks.forEach((w,i)=>{
    const wrap=document.createElement("div");wrap.className="week"+(w.isLibre?" libre":"");
    wrap.innerHTML=`<h3 class="${w.isLibre?"libre":""}">Semaine ${i+1} ‚Äî ${w.responsible}</h3>`;
    w.tasks.forEach(t=>{
      const dd=fmtDate(new Date(t.date));
      const row=document.createElement("div");row.className="task";
      row.textContent=`${t.icon} ${t.label} (${t.whenLabel}) ‚Äî ${dd}`;
      wrap.appendChild(row);
    });
    cont.appendChild(wrap);
  });
}

/* Init */
function init(){
  generateYearPlan();renderHome();renderWeeks();
  document.getElementById("tab-home").onclick=()=>setActiveTab("home");
  document.getElementById("tab-planning").onclick=()=>setActiveTab("planning");
  document.getElementById("prevMonth").onclick=()=>{if(currentMonthIndex>0){currentMonthIndex--;renderWeeks();}};
  document.getElementById("nextMonth").onclick=()=>{if(currentMonthIndex<FUTURE_MONTHS.length-1){currentMonthIndex++;renderWeeks();}};
}
init();setInterval(()=>{renderHome();},60000);
</script>
</body>
</html>
